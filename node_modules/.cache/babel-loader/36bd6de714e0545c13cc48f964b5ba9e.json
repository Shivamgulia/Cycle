{"ast":null,"code":"import _slicedToArray from\"/Users/shivamgulia/Developer/Green Riders/JS/cycle/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useState}from'react';import{useHistory}from'react-router-dom';import Scanner from'../components/QrScaner/Scanner';import{rentCycle}from'../components/lib/api';import useHttp from'../components/hooks/use-http';import Button from'../components/UI/Button';import AuthContext from'../store/auth-context';import LoadingSpinner from'../components/UI/LoadingSpinner';import classes from'./Rent.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Rent=function Rent(props){var history=useHistory();var authCtx=useContext(AuthContext);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),done=_useState4[0],setDone=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),rent=_useState6[0],setRent=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),one=_useState8[0],setOne=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),two=_useState10[0],setTwo=_useState10[1];//   console.log(authCtx);\nvar _useHttp=useHttp(rentCycle,false),sendRequest=_useHttp.sendRequest,status=_useHttp.status,error=_useHttp.error;var rentHandler=function rentHandler(){sendRequest({token:authCtx.token,cycleid:data,userid:authCtx.userid,role:authCtx.role});if(!two&&error)authCtx.addCycle(data);};useEffect(function(){setData(localStorage.getItem('scandata'));setDone(localStorage.getItem('scaned'));if(localStorage.getItem('scandata')==='undefined'){setData(null);setDone(false);localStorage.removeItem('scaned');localStorage.removeItem('scandata');}},[]);useEffect(function(){if(authCtx.role==='admin'){setOne(true);}if(authCtx.role==='guard'){setTwo(true);}if(authCtx.cycleid!==undefined&&authCtx.cycleid!==''){setRent(false);}},[authCtx,authCtx.role,rent,setRent,setOne,one,two,setTwo,authCtx.cycleid]);//   console.log({ user: localStorage.getItem('data') });\nif(status==='pending'){return/*#__PURE__*/_jsx(\"div\",{className:\"centered\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})});}if(error){return/*#__PURE__*/_jsx(\"p\",{className:\"centered\",children:error});}if(status==='completed'){return/*#__PURE__*/_jsxs(\"div\",{className:\"centered\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{className:\"centered\",children:two?'Cycle Returned':'Cycle Rented'})}),/*#__PURE__*/_jsx(\"div\",{children:two&&/*#__PURE__*/_jsx(Button,{click:function click(){history.go(0);},children:\"Return Another Cycle\"})})]});}var ScanComplete=function ScanComplete(props){setData(props);localStorage.setItem('scandata',props);setDone(true);localStorage.setItem('scaned',true);history.replace('/rent');};return/*#__PURE__*/_jsxs(\"div\",{className:classes.body,children:[!one&&!two&&/*#__PURE__*/_jsxs(\"div\",{className:classes.comp,children:[!rent&&/*#__PURE__*/_jsx(\"h1\",{className:\"centered\",children:\"You have already rented one Cycle\"}),rent&&/*#__PURE__*/_jsxs(_Fragment,{children:[!done&&/*#__PURE__*/_jsx(Scanner,{scan:ScanComplete}),data&&/*#__PURE__*/_jsx(\"p\",{className:classes.p,children:data}),done&&/*#__PURE__*/_jsx(Button,{click:rentHandler,children:\"Rent\"}),done&&/*#__PURE__*/_jsx(Button,{click:function click(){setDone(false);setData(null);},children:\"Scan Again\"})]})]}),two&&/*#__PURE__*/_jsxs(\"div\",{className:classes.comp,children:[!done&&/*#__PURE__*/_jsx(Scanner,{scan:ScanComplete}),data&&/*#__PURE__*/_jsx(\"p\",{className:classes.p,children:data}),done&&/*#__PURE__*/_jsx(Button,{click:rentHandler,children:\"Return\"}),done&&/*#__PURE__*/_jsx(Button,{click:function click(){setDone(false);setData(null);},children:\"Scan Again\"})]}),one&&!two&&/*#__PURE__*/_jsxs(\"div\",{className:classes.comp,children:[!done&&/*#__PURE__*/_jsx(Scanner,{scan:ScanComplete}),data&&/*#__PURE__*/_jsx(\"p\",{className:classes.p,children:data}),done&&/*#__PURE__*/_jsx(Button,{click:rentHandler,children:\"Admin\"})]})]});};export default Rent;","map":{"version":3,"sources":["/Users/shivamgulia/Developer/Green Riders/JS/cycle/src/pages/Rent.js"],"names":["useContext","useEffect","useState","useHistory","Scanner","rentCycle","useHttp","Button","AuthContext","LoadingSpinner","classes","Rent","props","history","authCtx","data","setData","done","setDone","rent","setRent","one","setOne","two","setTwo","sendRequest","status","error","rentHandler","token","cycleid","userid","role","addCycle","localStorage","getItem","removeItem","undefined","go","ScanComplete","setItem","replace","body","comp","p"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Scanner from '../components/QrScaner/Scanner';\nimport { rentCycle } from '../components/lib/api';\nimport useHttp from '../components/hooks/use-http';\nimport Button from '../components/UI/Button';\nimport AuthContext from '../store/auth-context';\nimport LoadingSpinner from '../components/UI/LoadingSpinner';\nimport classes from './Rent.module.css';\n\nconst Rent = (props) => {\n  const history = useHistory();\n  const authCtx = useContext(AuthContext);\n  const [data, setData] = useState(null);\n  const [done, setDone] = useState(false);\n  const [rent, setRent] = useState(true);\n  const [one, setOne] = useState(false);\n  const [two, setTwo] = useState(false);\n\n  //   console.log(authCtx);\n\n  let { sendRequest, status, error } = useHttp(rentCycle, false);\n  const rentHandler = () => {\n    sendRequest({\n      token: authCtx.token,\n      cycleid: data,\n      userid: authCtx.userid,\n      role: authCtx.role,\n    });\n    if (!two && error) authCtx.addCycle(data);\n  };\n  useEffect(() => {\n    setData(localStorage.getItem('scandata'));\n    setDone(localStorage.getItem('scaned'));\n    if (localStorage.getItem('scandata') === 'undefined') {\n      setData(null);\n      setDone(false);\n      localStorage.removeItem('scaned');\n      localStorage.removeItem('scandata');\n    }\n  }, []);\n  useEffect(() => {\n    if (authCtx.role === 'admin') {\n      setOne(true);\n    }\n    if (authCtx.role === 'guard') {\n      setTwo(true);\n    }\n    if (authCtx.cycleid !== undefined && authCtx.cycleid !== '') {\n      setRent(false);\n    }\n  }, [\n    authCtx,\n    authCtx.role,\n    rent,\n    setRent,\n    setOne,\n    one,\n    two,\n    setTwo,\n    authCtx.cycleid,\n  ]);\n  //   console.log({ user: localStorage.getItem('data') });\n  if (status === 'pending') {\n    return (\n      <div className=\"centered\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n  if (error) {\n    return <p className=\"centered\">{error}</p>;\n  }\n  if (status === 'completed') {\n    return (\n      <div className=\"centered\">\n        <div>\n          <h1 className=\"centered\">\n            {two ? 'Cycle Returned' : 'Cycle Rented'}\n          </h1>\n        </div>\n        <div>\n          {two && (\n            <Button\n              click={() => {\n                history.go(0);\n              }}\n            >\n              Return Another Cycle\n            </Button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  const ScanComplete = (props) => {\n    setData(props);\n    localStorage.setItem('scandata', props);\n    setDone(true);\n    localStorage.setItem('scaned', true);\n    history.replace('/rent');\n  };\n  return (\n    <div className={classes.body}>\n      {!one && !two && (\n        <div className={classes.comp}>\n          {!rent && (\n            <h1 className=\"centered\">You have already rented one Cycle</h1>\n          )}\n          {rent && (\n            <>\n              {!done && <Scanner scan={ScanComplete} />}\n              {data && <p className={classes.p}>{data}</p>}\n              {done && <Button click={rentHandler}>Rent</Button>}\n              {done && (\n                <Button\n                  click={() => {\n                    setDone(false);\n                    setData(null);\n                  }}\n                >\n                  Scan Again\n                </Button>\n              )}\n            </>\n          )}\n        </div>\n      )}\n      {two && (\n        <div className={classes.comp}>\n          {!done && <Scanner scan={ScanComplete} />}\n          {data && <p className={classes.p}>{data}</p>}\n          {done && <Button click={rentHandler}>Return</Button>}\n          {done && (\n            <Button\n              click={() => {\n                setDone(false);\n                setData(null);\n              }}\n            >\n              Scan Again\n            </Button>\n          )}\n        </div>\n      )}\n      {one && !two && (\n        <div className={classes.comp}>\n          {!done && <Scanner scan={ScanComplete} />}\n          {data && <p className={classes.p}>{data}</p>}\n          {done && <Button click={rentHandler}>Admin</Button>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Rent;\n"]},"metadata":{},"sourceType":"module"}