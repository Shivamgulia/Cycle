{"ast":null,"code":"import _slicedToArray from\"/Users/shivamgulia/Developer/Green Riders/JS/cycle/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,Suspense,useState,useEffect}from'react';import{Route,Switch,Redirect}from'react-router-dom';import Layout from'./components/layout/Layout';import LoadingSpinner from'./components/UI/LoadingSpinner';import AdminPage from'./pages/AdminPage';import Cycles from'./pages/Cycles';import AuthContext from'./store/auth-context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var NotFound=/*#__PURE__*/React.lazy(function(){return import('./pages/NotFound');});var ProfilePage=/*#__PURE__*/React.lazy(function(){return import('./pages/ProfilePage');});var AuthPage=/*#__PURE__*/React.lazy(function(){return import('./pages/AuthPage');});var Rent=/*#__PURE__*/React.lazy(function(){return import('./pages/Rent');});var Signup=/*#__PURE__*/React.lazy(function(){return import('./pages/Signup');});var authCtx=useContext(AuthContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAdmin=_useState4[0],setIsAdmin=_useState4[1];var loggedIn=authCtx.isLoggedIn;var dat=authCtx.data;useEffect(function(){if(loggedIn){setIsLoading(true);fetch('https://pacific-fortress-54764.herokuapp.com/users/login',{method:'POST',body:JSON.stringify({email:authCtx.email,password:authCtx.password}),headers:{'Content-Type':'application/json'}}).then(function(res){setIsLoading(false);if(res.ok){return res.json();}else{authCtx.logout();return res.json().then(function(data){var errorMessage='Authentication Failed';if(data&&data.error&&data.error.message){setIsLoading(false);errorMessage=data.error.message;}throw new Error(errorMessage);});}}).then(function(data){var experationTime=new Date(new Date().getTime()+ +36000000);authCtx.login(data,authCtx.password,data.token,data._id,data.role,data.cycleid,experationTime.toISOString());}).catch(function(err){alert(err.message);});}},[loggedIn]);useEffect(function(){if(authCtx.role==='admin'){setIsAdmin(true);}else{setIsAdmin(false);}},[isAdmin,authCtx.role,authCtx]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"centered\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})});}return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{className:\"centered\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})}),children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsxs(Route,{path:\"/\",exact:true,children:[loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/mainPage\"}),!loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/auth\"})]}),/*#__PURE__*/_jsxs(Route,{path:\"/signup\",children:[loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/mainPage\"}),!loggedIn&&/*#__PURE__*/_jsx(Signup,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/auth\",children:[loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/mainPage\"}),!loggedIn&&/*#__PURE__*/_jsx(AuthPage,{})]}),loggedIn&&/*#__PURE__*/_jsxs(Route,{path:\"/mainPage\",children:[loggedIn&&/*#__PURE__*/_jsx(ProfilePage,{user:dat}),!loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/auth\"})]}),loggedIn&&/*#__PURE__*/_jsxs(Route,{path:\"/rent\",children:[loggedIn&&/*#__PURE__*/_jsx(Rent,{user:dat}),!loggedIn&&/*#__PURE__*/_jsx(Redirect,{to:\"/auth\"})]}),loggedIn&&/*#__PURE__*/_jsxs(Route,{path:\"/admin\",children:[loggedIn&&isAdmin&&/*#__PURE__*/_jsx(AdminPage,{user:dat}),loggedIn&&!isAdmin&&/*#__PURE__*/_jsx(Redirect,{to:\"/auth\"}),!loggedIn&&!isAdmin&&/*#__PURE__*/_jsx(Redirect,{to:\"/auth\"})]}),/*#__PURE__*/_jsx(Route,{path:\"/cycles\",children:/*#__PURE__*/_jsx(Cycles,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",children:/*#__PURE__*/_jsx(NotFound,{})})]})})});}export default App;","map":{"version":3,"sources":["/Users/shivamgulia/Developer/Green Riders/JS/cycle/src/App.js"],"names":["React","useContext","Suspense","useState","useEffect","Route","Switch","Redirect","Layout","LoadingSpinner","AdminPage","Cycles","AuthContext","App","NotFound","lazy","ProfilePage","AuthPage","Rent","Signup","authCtx","isLoading","setIsLoading","isAdmin","setIsAdmin","loggedIn","isLoggedIn","dat","data","fetch","method","body","JSON","stringify","email","password","headers","then","res","ok","json","logout","errorMessage","error","message","Error","experationTime","Date","getTime","login","token","_id","role","cycleid","toISOString","catch","err","alert"],"mappings":"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","sourcesContent":["import React, { useContext, Suspense, useState, useEffect } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\n\nimport Layout from './components/layout/Layout';\nimport LoadingSpinner from './components/UI/LoadingSpinner';\nimport AdminPage from './pages/AdminPage';\nimport Cycles from './pages/Cycles';\nimport AuthContext from './store/auth-context';\n\nfunction App() {\n  const NotFound = React.lazy(() => import('./pages/NotFound'));\n  const ProfilePage = React.lazy(() => import('./pages/ProfilePage'));\n  const AuthPage = React.lazy(() => import('./pages/AuthPage'));\n  const Rent = React.lazy(() => import('./pages/Rent'));\n  const Signup = React.lazy(() => import('./pages/Signup'));\n\n  const authCtx = useContext(AuthContext);\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const loggedIn = authCtx.isLoggedIn;\n  const dat = authCtx.data;\n\n  useEffect(() => {\n    if (loggedIn) {\n      setIsLoading(true);\n      fetch('https://pacific-fortress-54764.herokuapp.com/users/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: authCtx.email,\n          password: authCtx.password,\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n        .then((res) => {\n          setIsLoading(false);\n          if (res.ok) {\n            return res.json();\n          } else {\n            authCtx.logout();\n            return res.json().then((data) => {\n              let errorMessage = 'Authentication Failed';\n              if (data && data.error && data.error.message) {\n                setIsLoading(false);\n                errorMessage = data.error.message;\n              }\n              throw new Error(errorMessage);\n            });\n          }\n        })\n        .then((data) => {\n          const experationTime = new Date(new Date().getTime() + +36000000);\n          authCtx.login(\n            data,\n            authCtx.password,\n            data.token,\n            data._id,\n            data.role,\n            data.cycleid,\n            experationTime.toISOString()\n          );\n        })\n        .catch((err) => {\n          alert(err.message);\n        });\n    }\n  }, [loggedIn]);\n\n  useEffect(() => {\n    if (authCtx.role === 'admin') {\n      setIsAdmin(true);\n    } else {\n      setIsAdmin(false);\n    }\n  }, [isAdmin, authCtx.role, authCtx]);\n\n  if (isLoading) {\n    return (\n      <div className=\"centered\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  return (\n    <Layout>\n      <Suspense\n        fallback={\n          <div className=\"centered\">\n            <LoadingSpinner />\n          </div>\n        }\n      >\n        <Switch>\n          <Route path=\"/\" exact>\n            {loggedIn && <Redirect to=\"/mainPage\" />}\n            {!loggedIn && <Redirect to=\"/auth\" />}\n          </Route>\n          <Route path=\"/signup\">\n            {loggedIn && <Redirect to=\"/mainPage\" />}\n            {!loggedIn && <Signup />}\n          </Route>\n          <Route path=\"/auth\">\n            {loggedIn && <Redirect to=\"/mainPage\" />}\n            {!loggedIn && <AuthPage />}\n          </Route>\n          {loggedIn && (\n            <Route path=\"/mainPage\">\n              {loggedIn && <ProfilePage user={dat} />}\n              {!loggedIn && <Redirect to=\"/auth\" />}\n            </Route>\n          )}\n          {loggedIn && (\n            <Route path=\"/rent\">\n              {loggedIn && <Rent user={dat} />}\n              {!loggedIn && <Redirect to=\"/auth\" />}\n            </Route>\n          )}\n          {loggedIn && (\n            <Route path=\"/admin\">\n              {loggedIn && isAdmin && <AdminPage user={dat} />}\n              {loggedIn && !isAdmin && <Redirect to=\"/auth\" />}\n              {!loggedIn && !isAdmin && <Redirect to=\"/auth\" />}\n            </Route>\n          )}\n          <Route path=\"/cycles\">\n            <Cycles />\n          </Route>\n          <Route path=\"*\">\n            <NotFound />\n          </Route>\n        </Switch>\n      </Suspense>\n    </Layout>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}