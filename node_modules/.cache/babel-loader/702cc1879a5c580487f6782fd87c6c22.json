{"ast":null,"code":"import _slicedToArray from\"/Users/shivamgulia/Developer/Microsoft/Green Rides/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useContext}from'react';import{useHistory}from'react-router-dom';import Recaptcha from'react-recaptcha';import AuthContext from'../../store/auth-context';import classes from'./AuthForm.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AuthForm=function AuthForm(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isVerified=_useState2[0],setIsVerified=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showPassword=_useState4[0],setShowPassword=_useState4[1];var authCtx=useContext(AuthContext);var emailInputRef=useRef();var passwordInputRef=useRef();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var verifyCallback=function verifyCallback(){setIsVerified(true);};var load=function load(){setIsVerified(false);};var toggleShowPassword=function toggleShowPassword(){if(showPassword)setShowPassword(false);if(!showPassword)setShowPassword(true);};var submitionHandler=function submitionHandler(event){event.preventDefault();if(isVerified){var enteredEmail=emailInputRef.current.value;var enteredPassword=passwordInputRef.current.value;setIsLoading(true);var url;url='https://cycle-renter.azurewebsites.net//users/login';//login send req url\nfetch(url,{method:'POST',body:JSON.stringify({email:enteredEmail,password:enteredPassword}),headers:{'Content-Type':'application/json'}}).then(function(res){setIsLoading(false);if(res.ok){return res.json();}else{return res.json().then(function(data){var errorMessage='Authentication Failed';if(data&&data.error&&data.error.message){setIsLoading(false);errorMessage=data.error.message;}throw new Error(errorMessage);});}}).then(function(data){var experationTime=new Date(new Date().getTime()+ +36000000);authCtx.login(data,enteredPassword,data.token,data._id,data.role,data.cycleid,experationTime.toISOString());history.replace('/');}).catch(function(err){alert(err.message);});}else{alert('Verify if you are human');}};var signupHandler=function signupHandler(){history.push('/signup');};return/*#__PURE__*/_jsxs(\"section\",{className:classes.auth,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitionHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Your Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"userName\",id:\"userName\",required:true,ref:emailInputRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Your Password\"}),/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',id:\"password\",required:true,ref:passwordInputRef})]}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onClick:toggleShowPassword}),\" Show Password\",/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Recaptcha// sitekey=\"6Lca1UcjAAAAAPFNGz3Qt6f8Ymn7fX0o5fdXj0kp\"\n,{sitekey:\"6LeV3kcjAAAAAD9upeP2NL8HTQvXNPjNPDnLkAMd\"// sitekey=\"6Lc-ulQiAAAAABhKNCmKmoGU_KlxbzPT0FXWxSBx\"\n,render:\"explicit\",verifyCallback:verifyCallback,onloadCallback:load})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[!isLoading&&/*#__PURE__*/_jsx(\"button\",{children:\"Login\"}),isLoading&&/*#__PURE__*/_jsx(\"p\",{children:\"Sending Request....\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.actions,children:/*#__PURE__*/_jsx(\"button\",{onClick:signupHandler,children:\" Sign Up\"})})]});};export default AuthForm;","map":{"version":3,"sources":["/Users/shivamgulia/Developer/Microsoft/Green Rides/src/components/auth/AuthForm.js"],"names":["useState","useRef","useContext","useHistory","Recaptcha","AuthContext","classes","AuthForm","history","isVerified","setIsVerified","showPassword","setShowPassword","authCtx","emailInputRef","passwordInputRef","isLoading","setIsLoading","verifyCallback","load","toggleShowPassword","submitionHandler","event","preventDefault","enteredEmail","current","value","enteredPassword","url","fetch","method","body","JSON","stringify","email","password","headers","then","res","ok","json","data","errorMessage","error","message","Error","experationTime","Date","getTime","login","token","_id","role","cycleid","toISOString","replace","catch","err","alert","signupHandler","push","auth","control","actions"],"mappings":"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","sourcesContent":["import { useState, useRef, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Recaptcha from 'react-recaptcha';\n\nimport AuthContext from '../../store/auth-context';\nimport classes from './AuthForm.module.css';\n\nconst AuthForm = () => {\n  const history = useHistory();\n\n  const [isVerified, setIsVerified] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const authCtx = useContext(AuthContext);\n\n  const emailInputRef = useRef();\n  const passwordInputRef = useRef();\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const verifyCallback = () => {\n    setIsVerified(true);\n  };\n  const load = () => {\n    setIsVerified(false);\n  };\n\n  const toggleShowPassword = () => {\n    if (showPassword) setShowPassword(false);\n    if (!showPassword) setShowPassword(true);\n  };\n\n  const submitionHandler = (event) => {\n    event.preventDefault();\n\n    if (isVerified) {\n      const enteredEmail = emailInputRef.current.value;\n      const enteredPassword = passwordInputRef.current.value;\n\n      setIsLoading(true);\n\n      let url;\n      url = 'https://cycle-renter.azurewebsites.net//users/login'; //login send req url\n\n      fetch(url, {\n        method: 'POST',\n        body: JSON.stringify({\n          email: enteredEmail,\n          password: enteredPassword,\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n        .then((res) => {\n          setIsLoading(false);\n          if (res.ok) {\n            return res.json();\n          } else {\n            return res.json().then((data) => {\n              let errorMessage = 'Authentication Failed';\n              if (data && data.error && data.error.message) {\n                setIsLoading(false);\n                errorMessage = data.error.message;\n              }\n              throw new Error(errorMessage);\n            });\n          }\n        })\n        .then((data) => {\n          const experationTime = new Date(new Date().getTime() + +36000000);\n          authCtx.login(\n            data,\n            enteredPassword,\n            data.token,\n            data._id,\n            data.role,\n            data.cycleid,\n            experationTime.toISOString()\n          );\n          history.replace('/');\n        })\n        .catch((err) => {\n          alert(err.message);\n        });\n    } else {\n      alert('Verify if you are human');\n    }\n  };\n\n  const signupHandler = () => {\n    history.push('/signup');\n  };\n\n  return (\n    <section className={classes.auth}>\n      <h1>Login</h1>\n      <form onSubmit={submitionHandler}>\n        <div className={classes.control}>\n          <label htmlFor=\"email\">Your Email</label>\n          <input type=\"userName\" id=\"userName\" required ref={emailInputRef} />\n        </div>\n        <div className={classes.control}>\n          <label htmlFor=\"password\">Your Password</label>\n          <input\n            type={showPassword ? 'text' : 'password'}\n            id=\"password\"\n            required\n            ref={passwordInputRef}\n          />\n        </div>\n        <input type=\"checkbox\" onClick={toggleShowPassword} /> Show Password\n        <div>\n          <Recaptcha\n            // sitekey=\"6Lca1UcjAAAAAPFNGz3Qt6f8Ymn7fX0o5fdXj0kp\"\n            sitekey=\"6LeV3kcjAAAAAD9upeP2NL8HTQvXNPjNPDnLkAMd\"\n            // sitekey=\"6Lc-ulQiAAAAABhKNCmKmoGU_KlxbzPT0FXWxSBx\"\n            render=\"explicit\"\n            verifyCallback={verifyCallback}\n            onloadCallback={load}\n          />\n        </div>\n        <div className={classes.actions}>\n          {!isLoading && <button>Login</button>}\n          {isLoading && <p>Sending Request....</p>}\n        </div>\n      </form>\n      <div className={classes.actions}>\n        <button onClick={signupHandler}> Sign Up</button>\n      </div>\n    </section>\n  );\n};\n\nexport default AuthForm;\n"]},"metadata":{},"sourceType":"module"}