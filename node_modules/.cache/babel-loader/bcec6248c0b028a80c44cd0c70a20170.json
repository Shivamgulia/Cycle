{"ast":null,"code":"import _slicedToArray from\"/Users/shivamgulia/Developer/Green Riders/JS/cycle/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";var logoutTimer;var AuthContext=/*#__PURE__*/React.createContext({token:'',isLoggedIn:false,userid:'',email:'',password:'',role:'',cycleid:'',data:{},name:'',login:function login(data,token,userid,role,cycleid){},logout:function logout(){},addCycle:function addCycle(){}});var calculateRemainingTime=function calculateRemainingTime(expirationTime){var currentTime=new Date().getTime();var adjExpirationTime=new Date(expirationTime).getTime();var remainingDuration=adjExpirationTime-currentTime;return remainingDuration;};var retrieveStoredData=function retrieveStoredData(){var storedToken=localStorage.getItem('token');var storedExpirationDate=localStorage.getItem('expirationTime');var storedUserId=localStorage.getItem('userid');var storedRole=localStorage.getItem('role');var storedEmail=localStorage.getItem('email');var storedPassword=localStorage.getItem('password');var storedCycle=localStorage.getItem('cycleid');var storedData=localStorage.getItem('data');var storedName=localStorage.getItem('name');var storedBranch=localStorage.getItem('branch');var storedRollno=localStorage.getItem('rollno');var remainingTime=calculateRemainingTime(storedExpirationDate);if(remainingTime<=360){localStorage.removeItem('token');localStorage.removeItem('expirationTime');localStorage.removeItem('userid');localStorage.removeItem('role');localStorage.removeItem('cycleid');localStorage.removeItem('data');localStorage.removeItem('name');localStorage.removeItem('password');localStorage.removeItem('email');localStorage.removeItem('branch');localStorage.removeItem('rollno');return null;}return{token:storedToken,userid:storedUserId,role:storedRole,cycleid:storedCycle,data:storedData,name:storedName,branch:storedBranch,password:storedPassword,email:storedEmail,rollno:storedRollno,duration:remainingTime};};export var AuthContextProvider=function AuthContextProvider(props){var tokenData=retrieveStoredData();var initialToken;var initialUserId;var initialRole;var initialCycle;var initialData;var initialName;var initialBranch;var initialRollno;var initialEmail;var initialPassword;if(tokenData){initialData=tokenData.data;initialToken=tokenData.token;initialUserId=tokenData.userid;initialRole=tokenData.role;initialCycle=tokenData.cycleid;initialPassword=tokenData.password;initialEmail=tokenData.email;initialName=tokenData.name;initialBranch=tokenData.branch;initialRollno=tokenData.rollno;}var _useState=useState(initialData),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(initialUserId),_useState4=_slicedToArray(_useState3,2),userid=_useState4[0],setUserId=_useState4[1];var _useState5=useState(initialRole),_useState6=_slicedToArray(_useState5,2),role=_useState6[0],setRole=_useState6[1];var _useState7=useState(initialToken),_useState8=_slicedToArray(_useState7,2),token=_useState8[0],setToken=_useState8[1];var _useState9=useState(initialCycle),_useState10=_slicedToArray(_useState9,2),cycle=_useState10[0],setCycle=_useState10[1];var _useState11=useState(initialPassword),_useState12=_slicedToArray(_useState11,2),password=_useState12[0],setPass=_useState12[1];var _useState13=useState(initialEmail),_useState14=_slicedToArray(_useState13,2),email=_useState14[0],setEmail=_useState14[1];var _useState15=useState(initialName),_useState16=_slicedToArray(_useState15,2),name=_useState16[0],setName=_useState16[1];var _useState17=useState(initialBranch),_useState18=_slicedToArray(_useState17,2),branch=_useState18[0],setBranch=_useState18[1];var _useState19=useState(initialRollno),_useState20=_slicedToArray(_useState19,2),rollno=_useState20[0],setRollno=_useState20[1];var userIsLoggedIn=!!token;var logoutHandler=useCallback(function(){setToken(null);setUserId(null);setRole(null);setCycle(null);setData(null);setName(null);setBranch(null);setPass(null);setEmail(null);setRollno(null);localStorage.removeItem('token');localStorage.removeItem('expirationTime');localStorage.removeItem('userid');localStorage.removeItem('role');localStorage.removeItem('email');localStorage.removeItem('password');localStorage.removeItem('cycleid');localStorage.removeItem('data');localStorage.removeItem('name');localStorage.removeItem('branch');localStorage.removeItem('rollno');localStorage.setItem('userIsLoggedIn',false);if(logoutTimer){clearTimeout(logoutTimer);}},[]);var addCycleHandler=function addCycleHandler(cycl){localStorage.setItem('cycleid',cycl);setCycle(cycl);console.log(cycl+' incycle'+cycle);};var loginHandler=function loginHandler(data,password,token,userid,role,cycle,expirationTime){var remainingTime=calculateRemainingTime(expirationTime);setData(data);setToken(token);setRole(role);setUserId(userid);setEmail(data.email);setName(data.name);setPass(password);setBranch(data.branch);setRollno(data.rollno);setCycle(cycle);localStorage.setItem('token',token);localStorage.setItem('role',role);localStorage.setItem('userid',userid);localStorage.setItem('cycleid',cycle);localStorage.setItem('name',data.name);localStorage.setItem('branch',data.branch);localStorage.setItem('password',password);localStorage.setItem('email',data.email);localStorage.setItem('rollno',data.rollno);localStorage.setItem('userIsLoggedIn',true);localStorage.setItem('expirationTime',expirationTime);localStorage.setItem('data',JSON.stringify(data));logoutTimer=setTimeout(logoutHandler,remainingTime);};useEffect(function(){if(tokenData){// console.log(tokenData.duration);\nlogoutTimer=setTimeout(logoutHandler,tokenData.duration);}},[tokenData,logoutHandler]);var contextValue={data:data,token:token,isLoggedIn:userIsLoggedIn,userid:userid,role:role,cycleid:cycle,email:email,password:password,name:name,branch:branch,rollno:rollno,login:loginHandler,logout:logoutHandler,addCycle:addCycleHandler};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:contextValue,children:props.children});};export default AuthContext;","map":{"version":3,"sources":["/Users/shivamgulia/Developer/Green Riders/JS/cycle/src/store/auth-context.js"],"names":["React","useState","useEffect","useCallback","logoutTimer","AuthContext","createContext","token","isLoggedIn","userid","email","password","role","cycleid","data","name","login","logout","addCycle","calculateRemainingTime","expirationTime","currentTime","Date","getTime","adjExpirationTime","remainingDuration","retrieveStoredData","storedToken","localStorage","getItem","storedExpirationDate","storedUserId","storedRole","storedEmail","storedPassword","storedCycle","storedData","storedName","storedBranch","storedRollno","remainingTime","removeItem","branch","rollno","duration","AuthContextProvider","props","tokenData","initialToken","initialUserId","initialRole","initialCycle","initialData","initialName","initialBranch","initialRollno","initialEmail","initialPassword","setData","setUserId","setRole","setToken","cycle","setCycle","setPass","setEmail","setName","setBranch","setRollno","userIsLoggedIn","logoutHandler","setItem","clearTimeout","addCycleHandler","cycl","console","log","loginHandler","JSON","stringify","setTimeout","contextValue","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\n\nlet logoutTimer;\n\nconst AuthContext = React.createContext({\n  token: '',\n  isLoggedIn: false,\n  userid: '',\n  email: '',\n  password: '',\n  role: '',\n  cycleid: '',\n  data: {},\n  name: '',\n  login: (data, token, userid, role, cycleid) => {},\n  logout: () => {},\n  addCycle: () => {},\n});\n\nconst calculateRemainingTime = (expirationTime) => {\n  const currentTime = new Date().getTime();\n  const adjExpirationTime = new Date(expirationTime).getTime();\n\n  const remainingDuration = adjExpirationTime - currentTime;\n\n  return remainingDuration;\n};\n\nconst retrieveStoredData = () => {\n  const storedToken = localStorage.getItem('token');\n  const storedExpirationDate = localStorage.getItem('expirationTime');\n  const storedUserId = localStorage.getItem('userid');\n  const storedRole = localStorage.getItem('role');\n  const storedEmail = localStorage.getItem('email');\n  const storedPassword = localStorage.getItem('password');\n  const storedCycle = localStorage.getItem('cycleid');\n  const storedData = localStorage.getItem('data');\n  const storedName = localStorage.getItem('name');\n  const storedBranch = localStorage.getItem('branch');\n  const storedRollno = localStorage.getItem('rollno');\n  const remainingTime = calculateRemainingTime(storedExpirationDate);\n\n  if (remainingTime <= 360) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('expirationTime');\n    localStorage.removeItem('userid');\n    localStorage.removeItem('role');\n    localStorage.removeItem('cycleid');\n    localStorage.removeItem('data');\n    localStorage.removeItem('name');\n    localStorage.removeItem('password');\n    localStorage.removeItem('email');\n    localStorage.removeItem('branch');\n    localStorage.removeItem('rollno');\n    return null;\n  }\n\n  return {\n    token: storedToken,\n    userid: storedUserId,\n    role: storedRole,\n    cycleid: storedCycle,\n    data: storedData,\n    name: storedName,\n    branch: storedBranch,\n    password: storedPassword,\n    email: storedEmail,\n    rollno: storedRollno,\n    duration: remainingTime,\n  };\n};\n\nexport const AuthContextProvider = (props) => {\n  const tokenData = retrieveStoredData();\n\n  let initialToken;\n  let initialUserId;\n  let initialRole;\n  let initialCycle;\n  let initialData;\n  let initialName;\n  let initialBranch;\n  let initialRollno;\n  let initialEmail;\n  let initialPassword;\n  if (tokenData) {\n    initialData = tokenData.data;\n    initialToken = tokenData.token;\n    initialUserId = tokenData.userid;\n    initialRole = tokenData.role;\n    initialCycle = tokenData.cycleid;\n    initialPassword = tokenData.password;\n    initialEmail = tokenData.email;\n    initialName = tokenData.name;\n    initialBranch = tokenData.branch;\n    initialRollno = tokenData.rollno;\n  }\n\n  const [data, setData] = useState(initialData);\n  const [userid, setUserId] = useState(initialUserId);\n  const [role, setRole] = useState(initialRole);\n  const [token, setToken] = useState(initialToken);\n  const [cycle, setCycle] = useState(initialCycle);\n  const [password, setPass] = useState(initialPassword);\n  const [email, setEmail] = useState(initialEmail);\n  const [name, setName] = useState(initialName);\n  const [branch, setBranch] = useState(initialBranch);\n  const [rollno, setRollno] = useState(initialRollno);\n\n  const userIsLoggedIn = !!token;\n\n  const logoutHandler = useCallback(() => {\n    setToken(null);\n    setUserId(null);\n    setRole(null);\n    setCycle(null);\n    setData(null);\n    setName(null);\n    setBranch(null);\n    setPass(null);\n    setEmail(null);\n    setRollno(null);\n    localStorage.removeItem('token');\n    localStorage.removeItem('expirationTime');\n    localStorage.removeItem('userid');\n    localStorage.removeItem('role');\n    localStorage.removeItem('email');\n    localStorage.removeItem('password');\n    localStorage.removeItem('cycleid');\n    localStorage.removeItem('data');\n    localStorage.removeItem('name');\n    localStorage.removeItem('branch');\n    localStorage.removeItem('rollno');\n    localStorage.setItem('userIsLoggedIn', false);\n\n    if (logoutTimer) {\n      clearTimeout(logoutTimer);\n    }\n  }, []);\n  const addCycleHandler = (cycl) => {\n    localStorage.setItem('cycleid', cycl);\n    setCycle(cycl);\n    console.log(cycl + ' incycle' + cycle);\n  };\n\n  const loginHandler = (\n    data,\n    password,\n    token,\n    userid,\n    role,\n    cycle,\n    expirationTime\n  ) => {\n    const remainingTime = calculateRemainingTime(expirationTime);\n    setData(data);\n    setToken(token);\n    setRole(role);\n    setUserId(userid);\n    setEmail(data.email);\n    setName(data.name);\n    setPass(password);\n    setBranch(data.branch);\n    setRollno(data.rollno);\n    setCycle(cycle);\n    localStorage.setItem('token', token);\n    localStorage.setItem('role', role);\n    localStorage.setItem('userid', userid);\n    localStorage.setItem('cycleid', cycle);\n    localStorage.setItem('name', data.name);\n    localStorage.setItem('branch', data.branch);\n    localStorage.setItem('password', password);\n    localStorage.setItem('email', data.email);\n    localStorage.setItem('rollno', data.rollno);\n    localStorage.setItem('userIsLoggedIn', true);\n    localStorage.setItem('expirationTime', expirationTime);\n    localStorage.setItem('data', JSON.stringify(data));\n\n    logoutTimer = setTimeout(logoutHandler, remainingTime);\n  };\n\n  useEffect(() => {\n    if (tokenData) {\n      // console.log(tokenData.duration);\n      logoutTimer = setTimeout(logoutHandler, tokenData.duration);\n    }\n  }, [tokenData, logoutHandler]);\n\n  const contextValue = {\n    data: data,\n    token: token,\n    isLoggedIn: userIsLoggedIn,\n    userid: userid,\n    role: role,\n    cycleid: cycle,\n    email: email,\n    password: password,\n    name: name,\n    branch: branch,\n    rollno: rollno,\n    login: loginHandler,\n    logout: logoutHandler,\n    addCycle: addCycleHandler,\n  };\n\n  return (\n    <AuthContext.Provider value={contextValue}>\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthContext;\n"]},"metadata":{},"sourceType":"module"}